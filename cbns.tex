%!TEX root = main.tex


\section{Causal Bayesian Networks}\label{sec:CBN}

When do causal relationships as defined by causal Bayesian networks exist? We will consider a simplified case where a single node may be intervened on, and find the implied see-do model. With this condition, according to \citet{pearl_causality:_2009}, a causal Bayesian network is a probability model $\prob{P}$, a collection of interventional probability models $\{\prob{P}_{\RV{X}=a}|a\in X_i\}$ and a directed acyclic graph $\mathcal{G}$ whose nodes are identified with some collection of variables, which we can group into three variables $\{\RV{W},\RV{X},\RV{Y}\}$, where $\RV{W}$ is the sequence of variables associated with the parents of $\RV{X}$ in $\mathcal{G}$, $\RV{X}$ is the ``intervenable'' node of $\mathcal{G}$ and $\RV{Y}$ are associated with the other nodes. The interventional probability models must all obey the truncated factorisation condition with respect to $\mathcal{G}$:
\begin{align}
    \prob{P}_{\RV{X}=a}^{\RV{W}\RV{X}\RV{Y}}(w,x,y) &= \prob{P}^{\RV{W}}(w)\prob{P}^{\RV{Y}|\RV{XW}}(y|x,w)\llbracket x=a \rrbracket\label{eq:truncated_fac2}
\end{align}

A standard interpretation of the observational and interventional probability distributions is that we have a sequence of observations modeled by $\RV{V}_A:=(\RV{W}_i,\RV{X}_i,\RV{Y}_i)_{i\in A}$ mutually independent and identically distributed according to $\prob{P}^{\RV{WXY}}$, and a sequence of consequences modeled by $\RV{V}_B:=(\RV{W}_i,\RV{X}_i,\RV{Y}_i)_{i\in B}$ mutually independent and identically distributed according to $\prob{P}_{\RV{X}=a}^{\RV{WXY}}$, and $\prob{P}$ and $\prob{P}_{\RV{X}=a}$ are coupled by Equation \ref{eq:truncated_fac2}. What it means for $\prob{P}$ and $\prob{P}_{\RV{X}=a}$ to be coupled is: if $\prob{P}$ is the ``actual'' distribution of observations, then $\prob{P}_{\RV{X}=a}$ is the ``actual'' distribution of consequences. This can be explicitly represented by introducing a variable $\RV{H}$ representing the ``actual'' distribution of observations, and we introduce a model $\model{U}^{\cdot|\RV{H}}$ such that
\begin{align}
    \prob{P}^{\RV{V}_i}&:=\model{U}^{\RV{V}_i|\RV{H}}(v|h)\text{ for some }h\in H\text{ and any }i\in A, v\in W\times X\times Y\label{eq:what_is_p}\\
    \prob{P}_{\RV{X}_j=a}^{\RV{V}_j}&:=\model{U}^{\RV{V}_j|\RV{HX}_j}(v|h,a)\text{ for some }h\in H\text{ and any }j\in B, v\in W\times X\times Y\label{eq:what_is_do}
\end{align}
We justify line \ref{eq:what_is_do} by noting that $\model{U}^{\RV{V}_i|\RV{HX}}$ is a Markov kernel $H\times X\kto W\times X\times Y$, which is the same type as the map $\kernel{Q}:=h,a\mapsto \prob{P}_{\RV{X}=a}$, and in addition Equation \ref{eq:truncated_fac2} ensures that defining $\model{U}^{\RV{V}_i|\RV{HX}}:=\kernel{Q}$ is consistent via Lemma \ref{lem:nocopy2}.

Note that the assumptions of mutual independence $\RV{V}_i\CI \RV{V}_{A\cup B\setminus \{i\}}|\RV{H}$ for $i\in A$ and $\RV{V}_j\CI \RV{V}_{A\cup B\setminus \{j\}}|\RV{HX}_j$ for $j\in B$ are required for the existence of $\model{U}^{\RV{V}_i|\RV{H}}$ and $\model{U}^{\RV{V}_j|\RV{HX}_j}$ respectively.

Then Equation \ref{eq:truncated_fac2} becomes
\begin{align}
    \model{U}^{\RV{W}_j\RV{X}_j\RV{Y}_j|\RV{HX}_j}(w,x,y|h,a) &= \model{U}^{\RV{W}_i|\RV{H}}(w)\model{U}^{\RV{Y}_i|\RV{X_iW_iH}}(y|x,w,h)\llbracket x=a \rrbracket & i\in A, j\in B \label{eq:truncated_fac3}
\end{align}
The only difference here is that the coupling between distributions of observations and consequences via $\RV{H}$ is explicit. 

In most situations, $A$ will be disjoint from $B$. While we don't necessarily want to rule out considering consequences to be equal to observations, we usually want to consider consequences that may take different values from observations.

For $i\in A$, $j\in B$, we can write $\model{U}^{\RV{V}_{i}\RV{V}_j|\RV{HX}_{j}}$ as follows
\begin{align}
    \model{U}^{\RV{V}_{i}\RV{V}_j|\RV{HX}_{j}} &= \tikzfig{cbn_sd2}\\
    \model{U}^{\RV{V}_j|\RV{HX}_j} &= \tikzfig{truncated_fac_definition}\\
    \implies \model{U}^{\RV{V}_A\RV{V}_j|\RV{HX}_{j}} &= \tikzfig{cbn_sd23}\label{eq:cbn_maybe_comb}
\end{align}

Note that we replace the single observation $\RV{V}_i$ with the full observations $\RV{V}_A$ as we will make use of them subsequently, and we can do this without issue due to the assumption of conditional independence among the $\RV{V}_k$s. It will be sufficient to consider a single consequence $\RV{V}_j$. Equation \ref{eq:cbn_maybe_comb} defines a model $\model{U}^{\cdot|\RV{HX}_j}$ which relates observations to consequences in the manner suggested by Equation \ref{eq:truncated_fac2}. We will call $\model{U}$ a ``CBN model''. We note that the model in Equation \ref{eq:cbn_maybe_comb} looks like a 2-comb:
\begin{align}
    \tikzfig{cbn_sd_2comb} \label{eq:cbn_2comb}
\end{align}

However, we have not at this point assumed that we have a convex set of strategies. Suppose we have some standard see-do model $\mathscr{M}:=\{\model{T}^{\RV{O}\RV{V}_B|\RV{HD}},\{\model{S}_\alpha^{\RV{D}|\RV{O}}|\alpha\in \mathscr{A}\}\}$. The question we want to ask is: when can we posit a see-do model $\{\model{U}^{\RV{V}_A\RV{V}_j|\RV{HX}_j},\{\model{R}_\alpha^{\RV{X}_j|\RV{V}_A\RV{W}_j\RV{H}}|\alpha\in \mathscr{A}\}\}$ consistent with $\mathscr{M}$ in the sense that, for all $\alpha\in \mathscr{A}$:
\begin{align}
    \model{P}^{\RV{V}_B|\RV{H}}_\alpha&:=\tikzfig{seedo_equality2}\\
    &=\tikzfig{seedo_equality} \label{eq:consistent}\\
    &=: \model{Q}^{\RV{V}_B|\RV{H}}_\alpha
\end{align}

\todo[inline]{I think reusing the same $\RV{H}$ between $\RV{U}$ and $\RV{T}$ is a mistake here. Maybe not a big problem, but ideally one would check!}
\begin{theorem}\label{th:seedo_rep}
Given a standard see-do model $\mathscr{M}:=\{\model{T}^{\RV{O}\RV{V}_B|\RV{HD}},\{\model{S}_\alpha^{\RV{D}|\RV{V}_A}|\alpha\in \mathscr{A}\}\}$ and a CBN model $\model{U}^{\RV{V}_A\RV{V}_j|\RV{HX}_j}$ as defined in Equation \ref{eq:cbn_maybe_comb}, assuming $\RV{W}_j$ is a pre-choice variable, then there exists a see-do model $\{\model{U}^{\RV{V}_i\RV{V}_j|\RV{HX}_j},\{\model{R}_\alpha^{\RV{X}_j|\RV{V}_A\RV{W}_j\RV{H}}|\alpha\in \mathscr{A}\}\}$ consistent with $\mathscr{M}$ if and only if
\begin{enumerate}
    \item $\RV{W}_j$ is a pre-choice variable, i.e. $(\RV{V}_A,\RV{W}_j)\CI_{\model{T}} \RV{D}|\RV{H}$
    \item $\model{T}^{\RV{V}_A\RV{W}_j|\RV{H}} = \model{U}^{\RV{V}_A\RV{W}_j|\RV{H}}$
    \item $\RV{Y}_j\CI_{\model{T}}\RV{D}|\RV{W}_j\RV{V}_A\RV{HX}_j$
    \item $\model{T}^{\RV{Y}_j|\RV{W}_j\RV{V}_A\RV{HX}_j} = \model{U}^{\RV{Y}_j|\RV{W}_j\RV{V}_A\RV{HX}_j}$
\end{enumerate}
\end{theorem}

\begin{proof}
\textbf{If:}
If all assumptions hold, we can write
\begin{align}
    \model{T}^{\RV{V}_A\RV{V}_j|\RV{HD}} = \tikzfig{t_vs_u}
\end{align}
For each $\model{S}_\alpha^{\RV{D}|\RV{V}_A}$, define
\begin{align}
    \model{R}_\alpha^{\RV{X}_j|\RV{V}_A\RV{W}_j\RV{H}}:= \tikzfig{defn_ra}
\end{align}
Then
\begin{align}
    &\tikzfig{seedo_equality2}\\
    &= \tikzfig{seedo_cbn_with_s}\\
    &= \tikzfig{seedo_equality}
\end{align}
\textbf{Only if:}
Suppose assumption 1 does not hold. Then there exists some $d,d'\in D$, $w\in W$, $h\in H$ such that $\model{T}^{\RV{W}_j|\RV{HD}}(w_j|h,d)\neq \model{T}^{\RV{W}_j|\RV{HD}}(w|h,d')$. Then choose $\model{S}_d^{\RV{D}|\RV{V}_A}:v_A\mapsto \delta_{d}$ and $\model{S}_{d'}^{\RV{D}|\RV{V}_A}:v\mapsto \delta_{d'}$ for all $v\in V^{|A|}$. Then define
\begin{align}
    \model{P}_d^{\RV{W}_j|\RV{H}}(w|h) &= \model{T}^{\RV{W}_j|\RV{HD}}(w_j|h,d)\\
                                       &\neq \model{T}^{\RV{W}_j|\RV{HD}}(w_j|h,d')\\
                                       &= \model{P}_{d'}^{\RV{W}_j|\RV{H}}(w|h)
\end{align}
But for any $\alpha, \alpha'$, $\model{Q}_\alpha^{\RV{W}_j|\RV{H}}=\model{Q}_{\alpha'}^{\RV{W}_j|\RV{H}}$ as $\RV{W}_j\CI_{\RV{U}} \RV{X}_j|\RV{H}$, so $\model{Q}\neq \model{P}$.
Suppose assumption 1 holds but assumption 2 does not. Then for any $\alpha$
\begin{align}
    \model{P}_\alpha^{\RV{V}_A\RV{W}_j|\RV{H}}&=\model{T}^{\RV{V}_A\RV{W}_j|\RV{H}}\\
                                              &\neq \model{U}^{\RV{V}_A\RV{W}_j|\RV{H}}\\
                                              &= \model{Q}_\alpha^{\RV{V}_A\RV{W}_j|\RV{H}}
\end{align}
Suppose assumption 3 does not hold. Then there is some $d,d'\in D$, $w\in W$, $h\in H$, $v\in V^{|A|}$, $x\in X$ and $y\in Y$ such that
\begin{align}
    \model{T}^{\RV{Y}_j|\RV{W}_j\RV{V}_A\RV{HX}_j\RV{D}}(y|w,v,h,x,d) &\neq \model{T}^{\RV{Y}_j|\RV{W}_j\RV{V}_A\RV{HX}_j\RV{D}}(y|w,v,h,x,d')\label{eq:not_indep}\\
    &\text{and }\model{T}^{\RV{X}_j\RV{W}_j\RV{V}_A|\RV{HD}}(x,w,v|h,d) >0\\
    &\text{and }\model{T}^{\RV{X}_j\RV{W}_j\RV{V}_A|\RV{HD}}(x,w,v|h,d') >0\\
\end{align}
The latter conditions hold as if Equation \ref{eq:not_indep} only held on sets of measure 0 then we could choose versions of the conditional probabilities such that the independence held.

Then
\begin{align}
    \model{P}_d^{\RV{Y}_j|\RV{W}_j\RV{V}_A\RV{HX}_j\RV{D}}(y|w,v,h,x)&= \model{T}^{\RV{Y}_j|\RV{W}_j\RV{V}_A\RV{HX}_j\RV{D}}(y|w,v,h,x,d)\\
    &\neq \model{T}^{\RV{Y}_j|\RV{W}_j\RV{V}_A\RV{HX}_j\RV{D}}(y|w,v,h,x,d')\\
    &= \model{P}_{d'}^{\RV{Y}_j|\RV{W}_j\RV{V}_A\RV{HX}_j\RV{D}}(y|w,v,h,x)\\
    \implies \model{P}_d^{\RV{Y}_j|\RV{W}_j\RV{V}_A\RV{HX}_j\RV{D}}(y|w,v,h,x) &\neq \model{Q}_d^{\RV{Y}_j|\RV{W}_j\RV{V}_A\RV{HX}_j\RV{D}}(y|w,v,h,x)\\
    \text{or } \model{P}_{d'}^{\RV{Y}_j|\RV{W}_j\RV{V}_A\RV{HX}_j\RV{D}}(y|w,v,h,x) &\neq \model{Q}_{d'}^{\RV{Y}_j|\RV{W}_j\RV{V}_A\RV{HX}_j\RV{D}}(y|w,v,h,x)
\end{align}
As the conditional probabilities disagree on a positive measure set, $\model{P}\neq\model{Q}$.

Suppose assumption 3 holds but assumption 4 does not. Then for some $h\in H$, some $w\in W$, $v\in V^{|A|}$, $x\in X$ with positive measure and some $y\in Y$
\begin{align}
    \model{P}_d^{\RV{Y}_j|\RV{W}_j\RV{V}_A\RV{HX}_j\RV{D}}(y|w,v,h,x)&= \model{T}^{\RV{Y}_j|\RV{W}_j\RV{V}_A\RV{HX}_j}(y|w,v,h,x)\\
    &\neq \model{U}^{\RV{Y}_j|\RV{W}_j\RV{V}_A\RV{HX}_j}(y|w,v,h,x)\\
    &\neq model{Q}_d^{\RV{Y}_j|\RV{W}_j\RV{V}_A\RV{HX}_j\RV{D}}(y|w,v,h,x)
\end{align}
\end{proof}

Conditional independences like $(\RV{V}_A,\RV{W}_j)\CI_{\model{T}} \RV{D}|\RV{H}$ and $\RV{Y}_j\CI_{\model{T}}\RV{D}|\RV{W}_j\RV{V}_A\RV{HX}_j$ bear some resemblance to the condition of ``limited unresponsiveness'' proposed by \citet{heckerman_decision-theoretic_1995}. They are conceptually similar in that they indicate that a particular variable does not ``depend on'' a decision $\RV{D}$ in some sense. As Heckerman points out, however, limited unresponsiveness is not equivalent to conditional independence. We tentatively speculate that there may be a relation between our ``pre-choice variables'' $(\RV{W}_j,\RV{V}_A,\RV{H})$ and the ``state'' in Heckerman's work crucial for defining limited unresponsiveness.

\subsection{Proxy control}

We say that $(\RV{V}_A,\RV{W}_j)\CI_{\model{T}} \RV{D}|\RV{H}$ expresses the notion that $\RV{W}_j$ is a \emph{pre-choice variable} and $(\RV{W}_j,\RV{V}_A,\RV{X}_j)$ are \emph{proxies for }$\RV{D}$ with respect to $\RV{Y}$ under conditions of full information. To justify this terminology, we note that under a strong assumption of identifiability $\RV{Y}_j\CI\RV{H}|\RV{W}_j\RV{V}_A\RV{X}_j$ (i.e. the observed data allow us to identify $\RV{H}$ for the purposes of determining $\RV{T}^{\RV{Y}_j|\RV{W}_j\RV{V}_A\RV{X}_j\RV{H}}$), then we can write
\begin{align}
    \model{T}^{\RV{V}_A\RV{V}_B|\RV{H}\RV{D}} &=\tikzfig{strong_identifiability}\\
                                              &=\tikzfig{strong_identifiability2}
                                              &= \model{T}^{\RV{V}_A\RV{W}_j\RV{X}_j|\RV{H}\RV{D}}\kernel{M}
\end{align}

That is, under conditions of full information, knowing how to control the proxies $(\RV{W}_j,\RV{V}_A,\RV{X}_j)$ is sufficient to control $\RV{Y}$. This echoes \citet{pearl_does_2018}'s view on causal effects representing ``stable characteristics'':
\begin{quote}
Smoking cannot be stopped by any legal or educational means available to us today; cigarette advertising can. That does not stop researchers from aiming to estimate ``the effect of smoking on cancer,'' and doing so from experiments in which they vary the instrument—cigarette advertisement—not smoking. The reason they would be interested in the atomic intervention $P(\text{cancer}|do(\text{smoking}))$ rather than (or in addition to) $P(\text{cancer}|do(\text{advertising}))$ is that the former represents a stable biological characteristic of the population, uncontaminated by social factors that affect susceptibility to advertisement, thus rendering it transportable across cultures and environments. With the help of this stable characteristic, one can assess the effects of a wide variety of practical policies, each employing a different smoking-reduction instrument.
\end{quote}